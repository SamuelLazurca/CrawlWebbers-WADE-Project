@prefix davi-meta: <https://purl.org/davi/vocab/meta#> .
@prefix davi-nist: <https://purl.org/davi/vocab/nist#> .
@prefix davi-mov:  <https://purl.org/davi/vocab/movielens#> .
@prefix owl:       <http://www.w3.org/2002/07/owl#> .
@prefix rdfs:      <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms:   <http://purl.org/dc/terms/> .
@prefix skos:      <http://www.w3.org/2004/02/skos/core#> .
@prefix schema:    <http://schema.org/> .
@prefix xsd:       <http://www.w3.org/2001/XMLSchema#> .
@prefix rdf:       <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .

# --- ONTOLOGY METADATA ---
davi-meta:Ontology a owl:Ontology ;
    rdfs:label "DaVi Dataset Registry & Visualization Ontology"@en ;
    dcterms:description "A modular metamodel for dataset registration, default visualization presets, and dynamic custom analytics configuration."@en ;
    owl:imports <http://schema.org/> .

# ==============================================================================
# CORE META-MODEL
# ==============================================================================

davi-meta:Dataset a owl:Class ;
    rdfs:label "Registered Dataset"@en ;
    rdfs:subClassOf schema:Dataset .

davi-meta:Visualization a owl:Class ;
    rdfs:label "Visualization Module"@en ;
    dcterms:description "A functional extension of the web app."@en .

davi-meta:supportsVisualization a owl:ObjectProperty ;
    rdfs:label "supports visualization"@en ;
    rdfs:domain davi-meta:Dataset ;
    rdfs:range davi-meta:Visualization .

davi-meta:uploader a owl:ObjectProperty ;
    rdfs:label "uploader"@en ;
    rdfs:domain davi-meta:Dataset ;
    rdfs:range schema:Person .

davi-meta:uiLabel a owl:DatatypeProperty ;
    rdfs:label "UI Label"@en ;
    rdfs:domain owl:Thing ;
    rdfs:range xsd:string .

# ==============================================================================
# VOCABULARY
# ==============================================================================

davi-meta:hasDimension a owl:ObjectProperty ;
    rdfs:label "has dimension"@en ;
    rdfs:domain davi-meta:Dataset ;
    rdfs:range rdf:Property .

davi-meta:hasMetric a owl:ObjectProperty ;
    rdfs:label "has metric"@en ;
    rdfs:domain davi-meta:Dataset ;
    rdfs:range rdf:Property .

davi-meta:isDimension a owl:AnnotationProperty ;
    rdfs:label "Is Dimension?" ;
    rdfs:range xsd:boolean .

davi-meta:isMetric a owl:AnnotationProperty ;
    rdfs:label "Is Metric?" ;
    rdfs:range xsd:boolean .

# --- Controlled Vocabularies ---
davi-meta:ChartType a owl:Class .
davi-meta:BarChart a davi-meta:ChartType .
davi-meta:LineChart a davi-meta:ChartType .
davi-meta:PieChart a davi-meta:ChartType .

davi-meta:AggregationFunction a owl:Class .
davi-meta:Count a davi-meta:AggregationFunction .
davi-meta:Sum a davi-meta:AggregationFunction .
davi-meta:Average a davi-meta:AggregationFunction .

# ==============================================================================
# PRESET CONFIGURATION CLASSES
# ==============================================================================

davi-meta:VisualizationOption a owl:Class ;
    rdfs:label "Visualization Preset"@en .

davi-meta:hasOption a owl:ObjectProperty ;
    rdfs:label "has preset option"@en ;
    rdfs:domain davi-meta:Visualization ;
    rdfs:range davi-meta:VisualizationOption .

davi-meta:targetProperty a owl:ObjectProperty ;
    rdfs:label "target RDF property"@en ;
    rdfs:domain davi-meta:VisualizationOption ;
    rdfs:range rdf:Property .

# ==============================================================================
# DATASET REGISTRY & SPECIFIC CONFIGURATIONS
# ==============================================================================

# --- NIST NVD Dataset ---
davi-meta:dataset_nist a davi-meta:Dataset ;
    dcterms:identifier "nist-nvd" ;
    schema:name "NIST National Vulnerability Database"@en ;
    schema:description "Security vulnerability records including CVE, CPE, and CWE data."@en ;
    schema:url <https://academictorrents.com/details/fe623a0bbd13e8f152ea2317f151d8d3719ba96b> ;
    schema:dateCreated "2025-06-01"^^xsd:date ;
    davi-meta:sizeBytes "1458628411"^^xsd:nonNegativeInteger ;
    davi-meta:fileCount "25183"^^xsd:nonNegativeInteger ;
    davi-meta:downloadCount "456"^^xsd:nonNegativeInteger ;
    davi-meta:uploader davi-meta:user_acme_researcher ;
    
    # Linked to NIST-Specific Visualization Instances
    davi-meta:supportsVisualization 
        davi-meta:viz_filtering_nist, 
        davi-meta:viz_trends_nist, 
        davi-meta:viz_hierarchy_nist ;

    # Custom Builder Config
    davi-meta:hasDimension davi-nist:affectsVendor ;
    davi-meta:hasDimension davi-nist:hasWeakness ;
    davi-meta:hasDimension schema:datePublished ;
    davi-meta:hasMetric davi-nist:baseScore .

davi-meta:user_acme_researcher a schema:Person ;
    schema:name "tripleshrimp" ;
    schema:url <https://academictorrents.com/userdetails.php?id=23855> .


# --- MovieLens 20M Dataset ---
davi-meta:dataset_movielens a davi-meta:Dataset ;
    dcterms:identifier "movielens-20m" ;
    schema:name "MovieLens 20M Dataset"@en ;
    schema:description "20 million ratings and Tag Genome relevance scores for movies."@en ;
    schema:url <https://academictorrents.com/details/296054417b4d8eeeb4c7b1c842570bf792ee4d14> ;
    schema:dateCreated "2016-10-17"^^xsd:date ;
    davi-meta:sizeBytes "198702078"^^xsd:nonNegativeInteger ;
    davi-meta:fileCount "1"^^xsd:nonNegativeInteger ;
    davi-meta:downloadCount "2257"^^xsd:nonNegativeInteger ;
    davi-meta:uploader davi-meta:user_grouplens_admin ;
    
    # Linked to MovieLens-Specific Visualization Instances
    davi-meta:supportsVisualization 
        davi-meta:viz_filtering_movielens, 
        davi-meta:viz_trends_movielens, 
        davi-meta:viz_network_movielens ;

    # Custom Builder Config
    davi-meta:hasDimension schema:genre ;
    davi-meta:hasDimension schema:datePublished ;
    davi-meta:hasMetric schema:ratingValue ;
    davi-meta:hasMetric davi-mov:relevanceScore .

davi-meta:user_grouplens_admin a schema:Person ;
    schema:name "joecohen" ;
    schema:url <https://academictorrents.com/userdetails.php?id=14> .


# ==============================================================================
# VISUALIZATION MODULE INSTANCES (presets)
# ==============================================================================

# --- Shared Options (Can be reused) ---
davi-meta:opt_trend_date a davi-meta:VisualizationOption ;
    davi-meta:uiLabel "Timeline (Published Date)" ;
    davi-meta:targetProperty schema:datePublished .

# -----------------------------------------------------------
# NIST SPECIFIC VISUALIZATIONS
# -----------------------------------------------------------

davi-meta:viz_filtering_nist a davi-meta:Visualization ;
    davi-meta:uiLabel "Intelligent Filtering" ;
    dcterms:description "Filter vulnerabilities."@en ;
    davi-meta:hasOption 
        davi-meta:opt_filter_vendor,
        davi-meta:opt_filter_weakness .

davi-meta:viz_trends_nist a davi-meta:Visualization ;
    davi-meta:uiLabel "Trends & Analytics" ;
    dcterms:description "Vulnerability trends over time and severity."@en ;
    davi-meta:hasOption 
        davi-meta:opt_trend_date,
        davi-meta:opt_trend_severity .

davi-meta:viz_hierarchy_nist a davi-meta:Visualization ;
    davi-meta:uiLabel "Hierarchical Explorer" ;
    dcterms:description "Explore CWE weakness tree."@en ;
    davi-meta:hasOption davi-meta:opt_layer_cwe .

# NIST Options
davi-meta:opt_filter_vendor a davi-meta:VisualizationOption ;
    davi-meta:uiLabel "By Vendor" ;
    davi-meta:targetProperty schema:manufacturer . 

davi-meta:opt_filter_weakness a davi-meta:VisualizationOption ;
    davi-meta:uiLabel "By Weakness (CWE)" ;
    davi-meta:targetProperty davi-nist:hasWeakness .

davi-meta:opt_trend_severity a davi-meta:VisualizationOption ;
    davi-meta:uiLabel "Severity Distribution (CVSS)" ;
    davi-meta:targetProperty davi-nist:baseScore .

davi-meta:opt_layer_cwe a davi-meta:VisualizationOption ;
    davi-meta:uiLabel "CWE Weakness Tree" ;
    davi-meta:targetProperty skos:broader .

# -----------------------------------------------------------
# MOVIELENS SPECIFIC VISUALIZATIONS
# -----------------------------------------------------------

davi-meta:viz_filtering_movielens a davi-meta:Visualization ;
    davi-meta:uiLabel "Intelligent Filtering" ;
    dcterms:description "Filter movies."@en ;
    davi-meta:hasOption 
        davi-meta:opt_filter_genre .

davi-meta:viz_trends_movielens a davi-meta:Visualization ;
    davi-meta:uiLabel "Trends & Analytics" ;
    dcterms:description "Movie ratings and release trends."@en ;
    davi-meta:hasOption 
        davi-meta:opt_trend_date,
        davi-meta:opt_trend_rating .

davi-meta:viz_network_movielens a davi-meta:Visualization ;
    davi-meta:uiLabel "Network Explorer" ;
    dcterms:description "Explore Genome connections."@en ;
    davi-meta:hasOption davi-meta:opt_layer_genome .

# MovieLens Options
davi-meta:opt_filter_genre a davi-meta:VisualizationOption ;
    davi-meta:uiLabel "By Genre" ;
    davi-meta:targetProperty schema:genre .

davi-meta:opt_trend_rating a davi-meta:VisualizationOption ;
    davi-meta:uiLabel "Rating Distribution" ;
    davi-meta:targetProperty schema:ratingValue .

davi-meta:opt_layer_genome a davi-meta:VisualizationOption ;
    davi-meta:uiLabel "Tag Genome Network" ;
    davi-meta:targetProperty davi-mov:relevanceScore .
