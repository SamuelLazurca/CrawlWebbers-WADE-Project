@prefix davi-mov:  <https://purl.org/davi/vocab/movielens#> .
@prefix davi-meta: <https://purl.org/davi/vocab/meta#> .
@prefix owl:       <http://www.w3.org/2002/07/owl#> .
@prefix rdf:       <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs:      <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd:       <http://www.w3.org/2001/XMLSchema#> .
@prefix dcterms:   <http://purl.org/dc/terms/> .
@prefix schema:    <http://schema.org/> .

# --- ONTOLOGY METADATA ---
davi-mov:MovieLensOntology a owl:Ontology ;
    rdfs:label "DaVi MovieLens Extensions"@en ;
    dcterms:description "Ontology for MovieLens 20M, mapped to DaVi Meta-Ontology."@en ;
    owl:imports <http://schema.org/> .

# --- CORE CONCEPTS (ENTITIES) ---
# We mark these as davi-meta:Concept so the UI lists them as 'Analysable Entities'

schema:Movie a owl:Class, davi-meta:Concept ;
    rdfs:label "Movie"@en ;
    davi-meta:uiLabel "Movies" ;
    davi-meta:icon "film" .

schema:Rating a owl:Class, davi-meta:Concept ;
    rdfs:label "Rating Action"@en ;
    davi-meta:uiLabel "User Ratings" .

schema:Person a owl:Class, davi-meta:Concept ;
    rdfs:label "User / Person"@en ;
    davi-meta:uiLabel "Users" .

davi-mov:TagApplication a owl:Class, davi-meta:Concept ;
    rdfs:label "Tag Application Event"@en ;
    davi-meta:uiLabel "User Tags" ;
    davi-meta:icon "tag" ;
    dcterms:description "An event where a user applies a free-text tag to a movie."@en .

davi-mov:GenomeRelevance a owl:Class, davi-meta:Concept ;
    rdfs:label "Genome Relevance Prediction"@en ;
    davi-meta:uiLabel "Genome Scores" ;
    davi-meta:icon "bar-chart" ;
    dcterms:description "The calculated relevance of a Genome Tag to a specific Movie."@en .

davi-mov:GenomeTag a owl:Class, davi-meta:Concept ;
    rdfs:label "Genome Tag"@en ;
    davi-meta:uiLabel "Genome Tags" .

# --- DIMENSIONS (CATEGORICAL & TEMPORAL) ---

# GENRE: Categorical Dimension
schema:genre a owl:ObjectProperty ;
    rdfs:label "Movie Genre"@en ;
    rdfs:domain schema:Movie ;
    davi-meta:isDimension "true"^^xsd:boolean ;
    davi-meta:uiLabel "Genre" ;
    davi-meta:visualizationType "Categorical" .

# DATE: Temporal Dimension (Crucial for Timeline Charts)
schema:datePublished a owl:DatatypeProperty ;
    rdfs:label "Release Date"@en ;
    rdfs:domain schema:Movie ;
    davi-meta:isDimension "true"^^xsd:boolean ;
    davi-meta:uiLabel "Release Year" ;
    davi-meta:visualizationType "Temporal" ;
    davi-meta:dateFormat "YYYY-MM-DD" .

# TAG CONTENT: Text Dimension (Word Clouds)
davi-mov:tagContent a owl:DatatypeProperty ;
    rdfs:label "Tag Text"@en ;
    rdfs:domain davi-mov:TagApplication ;
    rdfs:range xsd:string ;
    davi-meta:isDimension "true"^^xsd:boolean ;
    davi-meta:uiLabel "User Tag" ;
    davi-meta:visualizationType "Text" .

# TAGGING TIME: Temporal Dimension
schema:startTime a owl:DatatypeProperty ;
    rdfs:label "Tagging Date"@en ;
    rdfs:domain davi-mov:TagApplication ;
    davi-meta:isDimension "true"^^xsd:boolean ;
    davi-meta:uiLabel "Tagging Date" ;
    davi-meta:visualizationType "Temporal" .

# --- METRICS (NUMERICAL) ---

# RATING: The Primary Metric
schema:ratingValue a owl:DatatypeProperty ;
    rdfs:label "Rating Value"@en ;
    rdfs:domain schema:Rating ;
    rdfs:range xsd:decimal ;
    # It can be a dimension (group by score 1, 2, 3)
    davi-meta:isDimension "true"^^xsd:boolean ;
    # It is primarily a metric (Average Rating)
    davi-meta:isMetric "true"^^xsd:boolean ;
    davi-meta:uiLabel "Rating Score" ;
    davi-meta:defaultAggregation "AVG" ;   # <--- NEW: Tells engine to Average by default
    davi-meta:allowedAggregations "AVG", "COUNT", "MIN", "MAX" .

# GENOME RELEVANCE: Metric
davi-mov:relevanceScore a owl:DatatypeProperty ;
    rdfs:label "Relevance Score"@en ;
    rdfs:domain davi-mov:GenomeRelevance ;
    rdfs:range xsd:decimal ;
    davi-meta:isMetric "true"^^xsd:boolean ;
    davi-meta:uiLabel "Tag Relevance" ;
    davi-meta:defaultAggregation "AVG" .

# --- RELATIONSHIPS (Navigation) ---

schema:author a owl:ObjectProperty ;
    rdfs:domain schema:Rating ;
    rdfs:range schema:Person .

schema:itemReviewed a owl:ObjectProperty ;
    rdfs:domain schema:Rating ;
    rdfs:range schema:Movie .

davi-mov:taggedBy a owl:ObjectProperty ;
    rdfs:label "Tagged By"@en ;
    rdfs:domain davi-mov:TagApplication ;
    rdfs:range schema:Person .

davi-mov:tagsMovie a owl:ObjectProperty ;
    rdfs:label "Tagged Movie"@en ;
    rdfs:domain davi-mov:TagApplication ;
    rdfs:range schema:Movie .

davi-mov:isRelevantTo a owl:ObjectProperty ;
    rdfs:label "Relevant Movie"@en ;
    rdfs:domain davi-mov:GenomeRelevance ;
    rdfs:range schema:Movie .

davi-mov:hasGenomeTag a owl:ObjectProperty ;
    rdfs:label "Genome Tag"@en ;
    rdfs:domain davi-mov:GenomeRelevance ;
    rdfs:range davi-mov:GenomeTag ;
    davi-meta:isDimension "true"^^xsd:boolean ;
    davi-meta:uiLabel "Genome Tag Category" .
