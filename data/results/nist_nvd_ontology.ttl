@prefix davi-nist: <https://purl.org/davi/vocab/nist#> .
@prefix owl:  <http://www.w3.org/2002/07/owl#> .
@prefix rdf:  <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix schema: <http://schema.org/> .
@prefix xsd:  <http://www.w3.org/2001/XMLSchema#> .

# --- ONTOLOGY METADATA ---
davi-nist:NISTVulnerabilityOntology
    a owl:Ontology ;
    rdfs:label "DaVi NIST Security Extensions"@en ;
    dcterms:description "Extensions to Schema.org for NIST NVD Data (CVE, CWE, CPE, CVSS)"@en ;
    owl:imports <http://schema.org/> .

# --- REUSED STANDARD CLASSES ---
# We use these directly. Declaring them here aids visualization tools.

schema:SoftwareApplication a owl:Class ;
    rdfs:label "Software Application (CPE)"@en .

schema:Organization a owl:Class ;
    rdfs:label "Vendor / Organization"@en .

schema:Thing a owl:Class ;
    rdfs:label "Thing"@en .

# --- CUSTOM CLASSES ---

# Vulnerabilities are not standard in Schema.org, so we define them here.
davi-nist:Vulnerability a owl:Class ;
    rdfs:label "Vulnerability (CVE)"@en ;
    rdfs:subClassOf schema:Thing ;
    dcterms:description "A weakness in the computational logic (e.g., code) found in software and hardware components."@en .

# Weaknesses (CWE) are hierarchical concepts, so they subclass SKOS Concept.
davi-nist:Weakness a owl:Class ;
    rdfs:label "Weakness (CWE)"@en ;
    rdfs:subClassOf skos:Concept .

# Metrics for scoring severity
davi-nist:CVSSMetric a owl:Class ;
    rdfs:label "CVSS Metric"@en .

# --- CUSTOM PROPERTIES ---

# Linking Vulnerability -> Software (Standardized Range)
davi-nist:affectsSoftware a owl:ObjectProperty ;
    rdfs:label "affects software"@en ;
    rdfs:domain davi-nist:Vulnerability ;
    rdfs:range schema:SoftwareApplication .

# Linking Vulnerability -> Weakness (CWE)
davi-nist:hasWeakness a owl:ObjectProperty ;
    rdfs:label "has weakness"@en ;
    rdfs:domain davi-nist:Vulnerability ;
    rdfs:range davi-nist:Weakness ;
    owl:inverseOf davi-nist:isWeaknessOf .

davi-nist:isWeaknessOf a owl:ObjectProperty ;
    rdfs:label "is weakness of"@en ;
    rdfs:domain davi-nist:Weakness ;
    rdfs:range davi-nist:Vulnerability .

# CVSS Metrics
davi-nist:hasCVSSMetric a owl:ObjectProperty ;
    rdfs:label "has CVSS metric"@en ;
    rdfs:domain davi-nist:Vulnerability ;
    rdfs:range davi-nist:CVSSMetric .

davi-nist:baseScore a owl:DatatypeProperty ;
    rdfs:label "base score"@en ;
    rdfs:domain davi-nist:CVSSMetric ;
    rdfs:range xsd:decimal .

davi-nist:vectorString a owl:DatatypeProperty ;
    rdfs:label "vector string"@en ;
    rdfs:domain davi-nist:CVSSMetric ;
    rdfs:range xsd:string .

# --- LOGICAL AXIOMS (Inference) ---

# Inference Rule:
# IF (Vulnerability A affects Software B) AND (Software B is manufactured by Vendor C)
# THEN (Vulnerability A affects Vendor C)
davi-nist:affectsVendor a owl:ObjectProperty ;
    rdfs:label "affects vendor"@en ;
    rdfs:domain davi-nist:Vulnerability ;
    rdfs:range schema:Organization ;
    owl:propertyChainAxiom (
        davi-nist:affectsSoftware
        schema:manufacturer
    ) .
